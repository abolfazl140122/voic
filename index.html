<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุดุงุฑ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap');
        * {
            font-family: 'Vazirmatn', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
        }
        .profile-circle {
            background: linear-gradient(90deg, #000 50%, #ffd700 50%);
        }
        .gold-accent {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
        }
        .black-card {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes loadingBar {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- ุตูุญู ุงููู ููุฏูฺฏ -->
    <div id="initialLoading" class="min-h-screen flex items-center justify-center p-4">
        <div class="text-center">
            <div class="w-16 h-16 mx-auto mb-4 border-4 border-yellow-400 border-t-transparent rounded-full animate-spin"></div>
            <h1 class="text-2xl font-bold text-yellow-400 mb-2">ููุดุงุฑ</h1>
            <p class="text-gray-300">ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ...</p>
        </div>
    </div>
    <!-- ุตูุญู ุซุจุช ูุงู -->
    <div id="registerPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="black-card rounded-2xl shadow-2xl p-8 w-full max-w-md slide-in border border-yellow-500">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-yellow-400 mb-2">
                    <svg class="w-10 h-10 inline-block mr-2" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20,5H4C2.89,5 2,5.89 2,7V17C2,18.11 2.89,19 4,19H20C21.11,19 22,18.11 22,17V7C22,5.89 21.11,5 20,5M20,17H4V7H20V17M9.5,8A1.5,1.5 0 0,0 8,9.5A1.5,1.5 0 0,0 9.5,11A1.5,1.5 0 0,0 11,9.5A1.5,1.5 0 0,0 9.5,8M14.5,13A1.5,1.5 0 0,0 13,14.5A1.5,1.5 0 0,0 14.5,16A1.5,1.5 0 0,0 16,14.5A1.5,1.5 0 0,0 14.5,13Z"/>
                    </svg>
                    ููุดุงุฑ
                </h1>
                <p class="text-gray-300">ุจู ุจุงุฒ ููุดุงุฑ ุฎูุด ุขูุฏุฏ</p>
            </div>
            
            <div class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-yellow-400 mb-2">ูุงู ฺฉุงุฑุจุฑ</label>
                    <input type="text" id="username" class="w-full px-4 py-3 bg-gray-800 border border-yellow-500 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent text-white" placeholder="ูุงู ฺฉุงุฑุจุฑ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-yellow-400 mb-2">ุณู</label>
                    <input type="number" id="age" class="w-full px-4 py-3 bg-gray-800 border border-yellow-500 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent text-white" placeholder="ุณู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="terms" class="h-4 w-4 text-yellow-500 focus:ring-yellow-400 border-yellow-500 rounded bg-gray-800">
                    <label for="terms" class="mr-2 block text-sm text-gray-300">
                        ุชูุงู ููุงูู ุฑุง ูโูพุฐุฑู
                    </label>
                </div>
                
                <button onclick="register()" class="w-full gold-accent hover:bg-yellow-600 text-black font-bold py-3 px-4 rounded-lg transition duration-200">
                    ุซุจุช ูุงู
                </button>
            </div>
        </div>
    </div>

    <!-- ููู ุงุตู -->
    <div id="mainMenu" class="hidden min-h-screen p-4">
        <!-- ูุฏุฑ -->
        <div class="flex justify-between items-center mb-8">
            <!-- ูพุฑููุงู -->
            <div class="black-card rounded-xl p-4 shadow-lg flex items-center space-x-4 space-x-reverse border border-yellow-500">
                <div class="profile-circle w-12 h-12 rounded-full"></div>
                <div class="flex-1">
                    <div class="flex items-center space-x-2 space-x-reverse">
                        <div class="font-bold text-yellow-400" id="playerName">ฺฉุงุฑุจุฑ</div>
                        <button onclick="editName()" class="text-gray-400 hover:text-yellow-400 transition duration-200">
                            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="text-sm text-gray-300">
                        <svg class="w-4 h-4 inline-block ml-1" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M5,16L3,5H1V3H4L6,14H18.5L20.5,7H8V5H22L19.5,16H5Z"/>
                        </svg>
                        <span id="playerCups">0</span> ฺฉุงูพ
                    </div>
                </div>
            </div>
            
            <!-- ุชูุธูุงุช -->
            <button onclick="showSettings()" class="black-card p-3 rounded-xl shadow-lg hover:shadow-xl transition duration-200 border border-yellow-500">
                <svg class="w-6 h-6 text-yellow-400" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                </svg>
            </button>
        </div>

        <!-- ุฏฺฉููโูุง ุงุตู -->
        <div class="flex flex-col items-center justify-center min-h-[60vh] space-y-3">
            <button onclick="startOnlineGame()" class="gold-accent hover:bg-yellow-600 text-black font-medium py-3 px-6 rounded-lg text-base shadow-lg hover:shadow-xl transition duration-300 w-48">
                <svg class="w-5 h-5 inline-block ml-2" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M17,3A2,2 0 0,1 19,5V15A2,2 0 0,1 17,17H13V19H14A1,1 0 0,1 15,20H22V22H15A1,1 0 0,1 14,23H10A1,1 0 0,1 9,22H2V20H9A1,1 0 0,1 10,19H11V17H7C5.89,17 5,16.1 5,15V5A2,2 0 0,1 7,3H17M17,5H7V15H17V5Z"/>
                </svg>
                ุจุงุฒ ุขููุงู
            </button>
            <button onclick="showLevels()" class="black-card hover:bg-gray-700 text-yellow-400 font-medium py-3 px-6 rounded-lg text-base shadow-lg hover:shadow-xl transition duration-300 w-48 border border-yellow-500">
                <svg class="w-5 h-5 inline-block ml-2" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M7.5,4A5.5,5.5 0 0,0 2,9.5C2,10 2.09,10.5 2.22,11H6.3L7.57,7.63C7.87,6.83 9.05,6.75 9.43,7.63L11.5,13L12.09,11.58C12.22,11.25 12.57,11 13,11H21.78C21.91,10.5 22,10 22,9.5A5.5,5.5 0 0,0 16.5,4C14.64,4 13.04,4.92 12,6.34C10.96,4.92 9.36,4 7.5,4M3,12.5A1,1 0 0,0 2,13.5A1,1 0 0,0 3,14.5H5.44L11,20C12,20.9 12,20.9 13,20L18.56,14.5H21A1,1 0 0,0 22,13.5A1,1 0 0,0 21,12.5H13.4L12.47,14.8C12.07,15.81 10.92,15.67 10.55,14.83L8.5,9.5L7.54,11.83C7.39,12.21 7.05,12.5 6.6,12.5H3Z"/>
                </svg>
                ุดุฑูุน ุจุงุฒ
            </button>
        </div>

        <!-- ูพุงู ุฎุทุง ุงูุชุฑูุช -->
        <div id="internetError" class="hidden fixed top-4 left-4 right-4 z-50">
            <div class="black-card rounded-xl p-4 mx-auto max-w-md border border-red-500 bg-red-900 bg-opacity-20">
                <div class="flex items-center space-x-3 space-x-reverse">
                    <svg class="w-6 h-6 text-red-400 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,17A1.5,1.5 0 0,1 10.5,15.5A1.5,1.5 0 0,1 12,14A1.5,1.5 0 0,1 13.5,15.5A1.5,1.5 0 0,1 12,17M12,10A1,1 0 0,1 13,11V14A1,1 0 0,1 11,14V11A1,1 0 0,1 12,10Z"/>
                    </svg>
                    <div class="flex-1">
                        <div class="font-bold text-red-400 text-sm">ุฎุทุง ุงุชุตุงู ุงูุชุฑูุช</div>
                        <div class="text-red-300 text-xs">ุจุฑุง ูุฑูุฏ ุจู ุจุงุฒ ุญุชูุงู ุงูุชุฑูุช ุฎูุฏ ุฑุง ุฑูุดู ฺฉูุฏ</div>
                    </div>
                    <button onclick="hideInternetError()" class="text-red-400 hover:text-red-300">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- ุฏฺฉููโูุง ูพุงู -->
        <div class="fixed bottom-4 left-4 right-4 flex justify-center space-x-4 space-x-reverse">
            <button class="black-card p-3 rounded-xl shadow-lg hover:shadow-xl transition duration-200 flex-1 max-w-24 border border-yellow-500 text-yellow-400">
                <svg class="w-6 h-6 mx-auto mb-1" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19,7H18V6A2,2 0 0,0 16,4H8A2,2 0 0,0 6,6V7H5A1,1 0 0,0 4,8V19A3,3 0 0,0 7,22H17A3,3 0 0,0 20,19V8A1,1 0 0,0 19,7M8,6H16V7H8V6M18,19A1,1 0 0,1 17,20H7A1,1 0 0,1 6,19V9H18V19Z"/>
                </svg>
                <span class="text-xs">ูุฑูุดฺฏุงู</span>
            </button>
            <button class="black-card p-3 rounded-xl shadow-lg hover:shadow-xl transition duration-200 flex-1 max-w-24 border border-yellow-500 text-yellow-400">
                <svg class="w-6 h-6 mx-auto mb-1" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M16,12A2,2 0 0,1 18,10A2,2 0 0,1 20,12A2,2 0 0,1 18,14A2,2 0 0,1 16,12M10,12A2,2 0 0,1 12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12M4,12A2,2 0 0,1 6,10A2,2 0 0,1 8,12A2,2 0 0,1 6,14A2,2 0 0,1 4,12Z"/>
                </svg>
                <span class="text-xs">ฺุงูุดโูุง</span>
            </button>
            <button class="black-card p-3 rounded-xl shadow-lg hover:shadow-xl transition duration-200 flex-1 max-w-24 border border-yellow-500 text-yellow-400">
                <svg class="w-6 h-6 mx-auto mb-1" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M13,3V9H21V3M13,21H21V11H13M3,21H11V15H3M3,13H11V3H3V13Z"/>
                </svg>
                <span class="text-xs">ุชุงุฑุฎฺู</span>
            </button>
        </div>
    </div>

    <!-- ุตูุญู ุชูุธูุงุช -->
    <div id="settingsPage" class="hidden min-h-screen p-4">
        <div class="black-card rounded-2xl shadow-2xl p-6 max-w-md mx-auto border border-yellow-500">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-yellow-400">ุชูุธูุงุช</h2>
                <button onclick="hideSettings()" class="text-gray-400 hover:text-yellow-400">โ</button>
            </div>
            
            <div class="space-y-4">
                <button onclick="showGiftCodePanel()" class="w-full text-right p-4 hover:bg-gray-700 rounded-lg transition duration-200 text-gray-300 hover:text-yellow-400">
                    <svg class="w-5 h-5 inline-block ml-2" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
                    </svg>
                    ฺฉุฏ ูุฏู
                </button>
                <button onclick="showDevelopers()" class="w-full text-right p-4 hover:bg-gray-700 rounded-lg transition duration-200 text-gray-300 hover:text-yellow-400">
                    <svg class="w-5 h-5 inline-block ml-2" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M16,4C16.88,4 17.67,4.5 18,5.26L19,7H20A2,2 0 0,1 22,9V20A2,2 0 0,1 20,22H4A2,2 0 0,1 2,20V9C2,7.89 2.9,7 4,7H5L6,5.26C6.33,4.5 7.12,4 8,4H16M16.5,9A1.5,1.5 0 0,0 15,10.5V11.5A1.5,1.5 0 0,0 16.5,13A1.5,1.5 0 0,0 18,11.5V10.5A1.5,1.5 0 0,0 16.5,9M12,9A4,4 0 0,0 8,13A4,4 0 0,0 12,17A4,4 0 0,0 16,13A4,4 0 0,0 12,9Z"/>
                    </svg>
                    ุณุงุฒูุฏฺฏุงู
                </button>
                <button class="w-full text-right p-4 hover:bg-gray-700 rounded-lg transition duration-200 text-gray-300 hover:text-yellow-400">
                    <svg class="w-5 h-5 inline-block ml-2" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,3C16.97,3 21,7.03 21,12C21,16.97 16.97,21 12,21A9,9 0 0,1 3,12A9,9 0 0,1 12,3M12,8.5A3.5,3.5 0 0,0 8.5,12A3.5,3.5 0 0,0 12,15.5A3.5,3.5 0 0,0 15.5,12A3.5,3.5 0 0,0 12,8.5M12,13.5A1.5,1.5 0 0,1 10.5,12A1.5,1.5 0 0,1 12,10.5A1.5,1.5 0 0,1 13.5,12A1.5,1.5 0 0,1 12,13.5Z"/>
                    </svg>
                    ูพุดุชุจุงู
                </button>
            </div>
        </div>
    </div>

    <!-- ุตูุญู ุงูุชุฎุงุจ ูุฑุญูู -->
    <div id="levelsPage" class="hidden min-h-screen p-4">
        <div class="black-card rounded-2xl shadow-2xl p-6 max-w-2xl mx-auto border border-yellow-500">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-yellow-400">ุงูุชุฎุงุจ ูุฑุญูู</h2>
                <button onclick="backToMenu()" class="text-gray-400 hover:text-yellow-400">
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/>
                    </svg>
                </button>
            </div>
            
            <div class="grid grid-cols-5 gap-3" id="levelsGrid">
                <!-- ูุฑุงุญู ุงูุฌุง ุชููุฏ ูโุดููุฏ -->
            </div>
        </div>
    </div>

    <!-- ุตูุญู ุฌุณุชุฌู ุจุงุฒฺฉู -->
    <div id="searchingPage" class="hidden min-h-screen p-4">
        <div class="max-w-lg mx-auto">
            <!-- ูุฏุฑ -->
            <div class="black-card rounded-xl p-4 mb-6 text-center border border-yellow-500">
                <h2 class="text-2xl font-bold text-yellow-400 mb-2">ุฌุณุชุฌู ุญุฑู</h2>
                <p class="text-gray-300 text-sm">ุฏุฑ ุญุงู ุงูุชู ุจุงุฒฺฉู ููุงุณุจ ุจุฑุง ุดูุง...</p>
            </div>

            <!-- ุงููุดู ุฌุณุชุฌู -->
            <div class="black-card rounded-xl p-8 mb-6 text-center border border-yellow-500">
                <div class="relative mb-6">
                    <div class="w-24 h-24 mx-auto relative">
                        <!-- ุฏุงุฑูโูุง ูุชุญุฑฺฉ -->
                        <div class="absolute inset-0 border-4 border-yellow-400 rounded-full animate-spin border-t-transparent"></div>
                        <div class="absolute inset-2 border-4 border-yellow-600 rounded-full animate-spin border-b-transparent" style="animation-direction: reverse; animation-duration: 1.5s;"></div>
                        <div class="absolute inset-4 border-4 border-yellow-300 rounded-full animate-spin border-l-transparent" style="animation-duration: 2s;"></div>
                        
                        <!-- ุขฺฉูู ูุณุท -->
                        <div class="absolute inset-0 flex items-center justify-center">
                            <svg class="w-8 h-8 text-yellow-400" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M15.5,12C18,12 20,14 20,16.5C20,17.38 19.75,18.21 19.31,18.9L22.39,22L21,23.39L17.88,20.32C17.19,20.75 16.37,21 15.5,21C13,21 11,19 11,16.5C11,14 13,12 15.5,12M15.5,14A2.5,2.5 0 0,0 13,16.5A2.5,2.5 0 0,0 15.5,19A2.5,2.5 0 0,0 18,16.5A2.5,2.5 0 0,0 15.5,14M10,4A4,4 0 0,1 14,8C14,8.91 13.69,9.75 13.18,10.43C12.32,10.75 11.55,11.26 10.91,11.9L10,12A4,4 0 0,1 6,8A4,4 0 0,1 10,4M2,20V18C2,15.88 5.31,14.14 9.5,14C9.18,14.78 9,15.62 9,16.5C9,17.79 9.38,19 10,20H2Z"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="space-y-3">
                    <div class="flex items-center justify-center space-x-2 space-x-reverse">
                        <div class="w-2 h-2 bg-yellow-400 rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-yellow-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-2 h-2 bg-yellow-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        <div class="w-2 h-2 bg-yellow-400 rounded-full animate-bounce" style="animation-delay: 0.3s"></div>
                        <div class="w-2 h-2 bg-yellow-400 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
                    </div>
                    <p class="text-yellow-400 font-medium" id="searchStatus">ุฌุณุชุฌู ุจุงุฒฺฉูุงู ุขููุงู...</p>
                </div>
            </div>

            <!-- ุขูุงุฑ ุฌุณุชุฌู -->
            <div class="black-card rounded-xl p-4 mb-6 border border-yellow-500">
                <div class="grid grid-cols-2 gap-4 text-center">
                    <div>
                        <div class="text-2xl font-bold text-green-400" id="searchTime">12</div>
                        <div class="text-xs text-gray-400">ุซุงูู</div>
                    </div>
                    <div>
                        <div class="text-2xl font-bold text-blue-400" id="foundCount">3</div>
                        <div class="text-xs text-gray-400">ุงูุช ุดุฏู</div>
                    </div>
                </div>
            </div>

            <!-- ุฏฺฉูู ูุบู -->
            <button onclick="backToMenu()" class="w-full black-card hover:bg-gray-700 text-yellow-400 font-medium py-3 px-4 rounded-xl transition duration-200 border border-yellow-500">
                <svg class="w-5 h-5 inline-block ml-2" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                </svg>
                ูุบู ุฌุณุชุฌู
            </button>
        </div>
    </div>

    <!-- ุตูุญู ููุงุด ุญุฑู -->
    <div id="opponentPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="black-card rounded-2xl shadow-2xl p-8 text-center max-w-md w-full slide-in border border-yellow-500">
            <h2 class="text-2xl font-bold text-yellow-400 mb-6">ุญุฑู ูพุฏุง ุดุฏ!</h2>
            
            <div class="bg-gray-800 rounded-xl p-6 mb-6 border border-gray-600">
                <div class="profile-circle w-16 h-16 rounded-full mx-auto mb-4"></div>
                <div class="font-bold text-lg text-white" id="opponentName">ูุงุทูู</div>
                <div class="text-gray-300">
                    <svg class="w-4 h-4 inline-block ml-1" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M5,16L3,5H1V3H4L6,14H18.5L20.5,7H8V5H22L19.5,16H5Z"/>
                    </svg>
                    <span id="opponentCups">1180</span> ฺฉุงูพ
                </div>
            </div>
            
            <button onclick="startBattle()" class="w-full gold-accent hover:bg-yellow-600 text-black font-bold py-3 px-6 rounded-xl transition duration-200">
                <svg class="w-6 h-6 inline-block ml-2" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6.92,5H5L6.5,6.5C5.88,7.24 5.24,8.56 5.24,9.5C5.24,11.69 7.05,13.5 9.24,13.5C11.43,13.5 13.24,11.69 13.24,9.5C13.24,8.56 12.6,7.24 12,6.5L13.5,5H11.58L10.24,6.34L8.9,5H6.92M9.24,8.5C9.78,8.5 10.24,8.94 10.24,9.5C10.24,10.06 9.78,10.5 9.24,10.5C8.68,10.5 8.24,10.06 8.24,9.5C8.24,8.94 8.68,8.5 9.24,8.5M14.73,13.5C16.92,13.5 18.73,15.31 18.73,17.5C18.73,19.69 16.92,21.5 14.73,21.5C12.54,21.5 10.73,19.69 10.73,17.5C10.73,15.31 12.54,13.5 14.73,13.5M14.73,16.5C14.17,16.5 13.73,16.94 13.73,17.5C13.73,18.06 14.17,18.5 14.73,18.5C15.29,18.5 15.73,18.06 15.73,17.5C15.73,16.94 15.29,16.5 14.73,16.5Z"/>
                </svg>
                ุดุฑูุน ูุจุฑุฏ!
            </button>
        </div>
    </div>

    <!-- ุตูุญู ููุงุด ููุถูุน ุฑุงูุฏ -->
    <div id="roundTopicPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="black-card rounded-2xl shadow-2xl p-8 text-center max-w-md w-full slide-in border border-yellow-500">
            <h2 class="text-3xl font-bold text-yellow-400 mb-4">ุฑุงูุฏ <span id="currentRoundNum">1</span></h2>
            <div class="text-6xl mb-4" id="topicEmoji">๐ฌ</div>
            <h3 class="text-2xl font-bold text-yellow-400 mb-6" id="topicName">ุณููุง</h3>
            <div class="text-lg text-gray-300">ุดุฑูุน ุฏุฑ <span id="countdown">3</span> ุซุงูู...</div>
        </div>
    </div>

    <!-- ุตูุญู ุจุงุฒ -->
    <div id="gamePage" class="hidden min-h-screen p-4">
        <!-- ูุฏุฑ ุจุงุฒ -->
        <div class="black-card rounded-xl p-4 mb-4 shadow-lg border border-yellow-500">
            <div class="flex justify-between items-center mb-2">
                <div class="text-center">
                    <div class="profile-circle w-8 h-8 rounded-full mx-auto mb-1"></div>
                    <div class="text-sm font-bold text-yellow-400" id="gamePlayerName">ุดูุง</div>
                    <div class="text-xs text-green-400" id="playerScore">0 โ</div>
                </div>
                
                <div class="text-center">
                    <div class="text-2xl font-bold text-red-400" id="timer">40</div>
                    <div class="text-xs text-gray-300">ุซุงูู</div>
                </div>
                
                <div class="text-center">
                    <div class="profile-circle w-8 h-8 rounded-full mx-auto mb-1"></div>
                    <div class="text-sm font-bold text-yellow-400" id="gameOpponentName">ุญุฑู</div>
                    <div class="text-xs text-green-400" id="opponentScore">0 โ</div>
                </div>
            </div>
            
            <div class="text-center">
                <span class="bg-yellow-500 text-black px-3 py-1 rounded-full text-sm font-medium" id="gameTopicName">ุณููุง</span>
                <span class="text-gray-300 text-sm mr-2">ุฑุงูุฏ <span id="gameRoundNum">1</span> ุงุฒ 3</span>
            </div>
        </div>

        <!-- ุณูุงู -->
        <div class="black-card rounded-xl p-6 mb-4 shadow-lg border border-yellow-500">
            <h3 class="text-xl font-bold text-yellow-400 mb-4 text-center" id="questionText">ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ุณูุงู...</h3>
            
            <div class="grid grid-cols-2 gap-3" id="answersGrid">
                <!-- ฺฏุฒููโูุง ุงูุฌุง ุชููุฏ ูโุดููุฏ -->
            </div>
        </div>

        <!-- ููุงุด ูุถุนุช -->
        <div class="black-card rounded-xl p-4 shadow-lg border border-yellow-500">
            <div class="text-center text-sm text-gray-300" id="gameStatus">ููุชุธุฑ ูพุงุณุฎ ุดูุง...</div>
        </div>

        <!-- ุชุงูุฑ ุณูุงู ุจุนุฏ -->
        <div id="nextQuestionTimer" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="black-card rounded-2xl p-8 text-center border border-blue-500">
                <div class="text-6xl mb-4">โฐ</div>
                <h3 class="text-2xl font-bold text-blue-400 mb-4">ุณูุงู ุจุนุฏ</h3>
                <div class="text-4xl font-bold text-blue-400 mb-2" id="nextQuestionCountdown">5</div>
                <div class="text-blue-300">ุซุงูู ุฏฺฏุฑ</div>
            </div>
        </div>
    </div>

    <!-- ุตูุญู ูพุงุงู ุจุงุฒ -->
    <div id="gameEndPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="black-card rounded-2xl shadow-2xl p-8 text-center max-w-md w-full slide-in border border-yellow-500">
            <div class="text-6xl mb-4" id="resultEmoji">๐</div>
            <h2 class="text-3xl font-bold mb-6 text-yellow-400" id="resultTitle">ูพุฑูุฒ!</h2>
            
            <div class="bg-gray-800 rounded-xl p-6 mb-6 border border-gray-600">
                <div class="grid grid-cols-2 gap-4 text-center">
                    <div>
                        <div class="font-bold text-lg text-yellow-400" id="finalPlayerName">ุดูุง</div>
                        <div class="text-green-400" id="finalPlayerCorrect">5 โ</div>
                        <div class="text-red-400" id="finalPlayerWrong">2 โ</div>
                    </div>
                    <div>
                        <div class="font-bold text-lg text-yellow-400" id="finalOpponentName">ุญุฑู</div>
                        <div class="text-green-400" id="finalOpponentCorrect">3 โ</div>
                        <div class="text-red-400" id="finalOpponentWrong">4 โ</div>
                    </div>
                </div>
            </div>
            
            <button onclick="backToMenuFromResults()" class="w-full gold-accent hover:bg-yellow-600 text-black font-bold py-3 px-6 rounded-xl transition duration-200">
                ุจุงุฒฺฏุดุช ุจู ููู
            </button>
        </div>
    </div>

    <!-- ุตูุญู ุณุงุฒูุฏฺฏุงู -->
    <div id="developersPage" class="hidden min-h-screen p-4">
        <div class="black-card rounded-2xl shadow-2xl p-6 max-w-md mx-auto border border-yellow-500">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-yellow-400">ุณุงุฒูุฏฺฏุงู</h2>
                <button onclick="hideSettings()" class="text-gray-400 hover:text-yellow-400">โ</button>
            </div>
            
            <div class="space-y-4 mb-6">
                <div class="bg-gray-800 rounded-lg p-4 border border-gray-600">
                    <div class="font-bold text-yellow-400 mb-1">Ali.k</div>
                    <div class="text-sm text-gray-300">ุจุฑูุงูู ููุณ ุงุฑุดุฏ</div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-4 border border-gray-600">
                    <div class="font-bold text-yellow-400 mb-1">Abolfazl1401</div>
                    <div class="text-sm text-gray-300">ุจุฑูุงูู ููุณ ุฏูู</div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-4 border border-gray-600">
                    <div class="font-bold text-yellow-400 mb-1">Vahid</div>
                    <div class="text-sm text-gray-300">ุทุฑุงุญ ุฑุงุจุท ฺฉุงุฑุจุฑ</div>
                </div>
                
                <div class="bg-gray-800 rounded-lg p-4 border border-gray-600">
                    <div class="font-bold text-green-400 mb-1">ุชุดฺฉุฑ ูฺู</div>
                    <div class="text-sm text-gray-300">Hussein</div>
                </div>
            </div>
            
            <div class="text-center text-xs text-gray-400 border-t border-gray-600 pt-4">
                ุชูุงู ุญููู ุงู ุงูพูฺฉุดู ูุชุนูู ุจู ุชู ุงุณฺฉูุฑุช ฺฏู ุงุณุช
            </div>
        </div>
    </div>

    <!-- ูพูู ูุฑุงุด ูุงู -->
    <div id="editNamePanel" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="black-card rounded-2xl shadow-2xl p-6 w-full max-w-md slide-in border border-yellow-500">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-yellow-400">ูุฑุงุด ูุงู</h2>
                <button onclick="hideEditNamePanel()" class="text-gray-400 hover:text-yellow-400">โ</button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-yellow-400 mb-2">ูุงู ุฌุฏุฏ</label>
                    <input type="text" id="newNameInput" class="w-full px-4 py-3 bg-gray-800 border border-yellow-500 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent text-white" placeholder="ูุงู ุฌุฏุฏ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                </div>
                
                <div class="flex space-x-3 space-x-reverse">
                    <button onclick="saveNewName()" class="flex-1 gold-accent hover:bg-yellow-600 text-black font-bold py-3 px-4 rounded-lg transition duration-200">
                        ุฐุฎุฑู
                    </button>
                    <button onclick="hideEditNamePanel()" class="flex-1 black-card hover:bg-gray-700 text-yellow-400 font-medium py-3 px-4 rounded-lg transition duration-200 border border-yellow-500">
                        ูุบู
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ูพูู ฺฉุฏ ูุฏู -->
    <div id="giftCodePanel" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="black-card rounded-2xl shadow-2xl p-6 w-full max-w-md slide-in border border-yellow-500">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-yellow-400">ฺฉุฏ ูุฏู</h2>
                <button onclick="hideGiftCodePanel()" class="text-gray-400 hover:text-yellow-400">โ</button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-yellow-400 mb-2">ฺฉุฏ ูุฏู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ</label>
                    <input type="text" id="giftCodeInput" class="w-full px-4 py-3 bg-gray-800 border border-yellow-500 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent text-white" placeholder="ฺฉุฏ ูุฏู ุฑุง ุงูุฌุง ูุงุฑุฏ ฺฉูุฏ">
                </div>
                
                <div class="flex space-x-3 space-x-reverse">
                    <button onclick="applyGiftCode()" class="flex-1 gold-accent hover:bg-yellow-600 text-black font-bold py-3 px-4 rounded-lg transition duration-200">
                        ุงุนูุงู ฺฉุฏ
                    </button>
                    <button onclick="hideGiftCodePanel()" class="flex-1 black-card hover:bg-gray-700 text-yellow-400 font-medium py-3 px-4 rounded-lg transition duration-200 border border-yellow-500">
                        ูุบู
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ุตูุญู ููุฏูฺฏ -->
    <div id="loadingPage" class="hidden min-h-screen flex items-center justify-center p-4">
        <div class="text-center">
            <div class="mb-8 relative">
                <!-- ููุฑ ูพุดุช ุชุตูุฑ -->
                <div class="absolute inset-0 w-40 h-40 mx-auto bg-yellow-400 rounded-full opacity-20 blur-3xl animate-pulse"></div>
                <div class="absolute inset-0 w-32 h-32 mx-auto bg-yellow-300 rounded-full opacity-30 blur-2xl animate-pulse" style="animation-delay: 0.5s"></div>
                
                <!-- ุชุตูุฑ ุจุฏูู ฺฉุงุฏุฑ -->
                <img src="https://s6.uupload.ir/files/img_20250813_002913_529_p11m.jpg" alt="ููุดุงุฑ" class="w-32 h-32 mx-auto rounded-2xl shadow-2xl relative z-10">
                
                <!-- ุญูููโูุง ูุชุญุฑฺฉ ุฏูุฑ ุชุตูุฑ -->
                <div class="absolute inset-0 w-40 h-40 mx-auto border-2 border-yellow-400 rounded-full animate-spin opacity-60" style="animation-duration: 3s;"></div>
                <div class="absolute inset-0 w-36 h-36 mx-auto border-2 border-yellow-300 rounded-full animate-spin opacity-40" style="animation-duration: 2s; animation-direction: reverse;"></div>
            </div>
            
            <h1 class="text-4xl font-bold text-yellow-400 mb-2 animate-pulse">ููุดุงุฑ</h1>
            <p class="text-yellow-300 text-lg mb-6 animate-pulse">ุชุณุช ููุด ู ุฏุงูุด</p>
            
            <!-- ุงููุดู ููุฏูฺฏ ูพุดุฑูุชู -->
            <div class="mb-4" id="loadingProgress">
                <div class="w-64 h-2 bg-gray-700 rounded-full mx-auto overflow-hidden">
                    <div class="h-full bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-full animate-pulse" style="width: 0%; animation: loadingBar 7s ease-in-out infinite;"></div>
                </div>
            </div>
            
            <div class="flex justify-center items-center space-x-2 space-x-reverse mb-4" id="loadingDots">
                <div class="w-3 h-3 bg-yellow-400 rounded-full animate-bounce"></div>
                <div class="w-3 h-3 bg-yellow-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                <div class="w-3 h-3 bg-yellow-400 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
                <div class="w-3 h-3 bg-yellow-400 rounded-full animate-bounce" style="animation-delay: 0.6s"></div>
                <div class="w-3 h-3 bg-yellow-400 rounded-full animate-bounce" style="animation-delay: 0.8s"></div>
            </div>
            
            <p class="text-gray-300 text-sm animate-pulse" id="loadingText">ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ููุงุจุน...</p>
            
            <!-- ูพุงู ุฎุทุง ุงูุชุฑูุช ุฏุฑ ููุฏูฺฏ -->
            <div id="loadingInternetError" class="hidden mt-6">
                <div class="black-card rounded-xl p-4 mx-auto max-w-md border border-red-500 bg-red-900 bg-opacity-20">
                    <div class="flex items-center space-x-3 space-x-reverse mb-4">
                        <svg class="w-6 h-6 text-red-400 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,17A1.5,1.5 0 0,1 10.5,15.5A1.5,1.5 0 0,1 12,14A1.5,1.5 0 0,1 13.5,15.5A1.5,1.5 0 0,1 12,17M12,10A1,1 0 0,1 13,11V14A1,1 0 0,1 11,14V11A1,1 0 0,1 12,10Z"/>
                        </svg>
                        <div class="flex-1">
                            <div class="font-bold text-red-400 text-sm">ุฎุทุง ุงุชุตุงู ุงูุชุฑูุช</div>
                            <div class="text-red-300 text-xs">ูุทูุงู ุงุชุตุงู ุงูุชุฑูุช ุฎูุฏ ุฑุง ุจุฑุฑุณ ฺฉูุฏ</div>
                        </div>
                    </div>
                    <div class="flex space-x-3 space-x-reverse">
                        <button onclick="retryConnection()" class="flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                            ุชูุงุด ูุฌุฏุฏ
                        </button>
                        <button onclick="exitApp()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                            ุฎุฑูุฌ
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ูุชุบุฑูุง ุจุงุฒ
        let gameState = {
            player: { name: '', cups: 0, score: 0, correct: 0, wrong: 0, isDeveloper: false },
            opponent: { name: '', cups: 0, score: 0, correct: 0, wrong: 0 },
            currentRound: 1,
            currentQuestion: 0,
            timer: 40,
            gameTimer: null,
            questionTimer: null,
            isOnlineGame: false,
            currentLevel: 1,
            playerAnswered: false
        };

        // ุจุงุฑฺฏุฐุงุฑ ุงุทูุงุนุงุช ุฐุฎุฑู ุดุฏู
        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('hooshyarGame');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    gameState.player.name = data.name || '';
                    gameState.player.cups = data.cups || 0;
                    gameState.currentLevel = data.currentLevel || 1;
                    gameState.player.isDeveloper = data.isDeveloper || false;
                    return true;
                }
            } catch (error) {
                console.log('ุฎุทุง ุฏุฑ ุจุงุฑฺฏุฐุงุฑ ุงุทูุงุนุงุช:', error);
                // ูพุงฺฉ ฺฉุฑุฏู ุงุทูุงุนุงุช ุฎุฑุงุจ
                localStorage.removeItem('hooshyarGame');
            }
            return false;
        }

        // ุฐุฎุฑู ุงุทูุงุนุงุช
        function saveData() {
            try {
                const dataToSave = {
                    name: gameState.player.name,
                    cups: gameState.player.cups,
                    currentLevel: gameState.currentLevel,
                    isDeveloper: gameState.player.isDeveloper
                };
                localStorage.setItem('hooshyarGame', JSON.stringify(dataToSave));
            } catch (error) {
                console.log('ุฎุทุง ุฏุฑ ุฐุฎุฑู ุงุทูุงุนุงุช:', error);
            }
        }

        // ููุงุด ูพูู ฺฉุฏ ูุฏู
        function showGiftCodePanel() {
            document.getElementById('giftCodeInput').value = '';
            document.getElementById('giftCodePanel').classList.remove('hidden');
        }

        // ูพููุงู ฺฉุฑุฏู ูพูู ฺฉุฏ ูุฏู
        function hideGiftCodePanel() {
            document.getElementById('giftCodePanel').classList.add('hidden');
        }

        // ุงุนูุงู ฺฉุฏ ูุฏู
        function applyGiftCode() {
            const code = document.getElementById('giftCodeInput').value.trim();
            
            if (code === '') {
                alert('ูุทูุงู ฺฉุฏ ูุฏู ุฑุง ูุงุฑุฏ ฺฉูุฏ!');
                return;
            }
            
            if (code === 'alljebhflebppllpbvgggffccccccvvhkkbfdxbh') {
                gameState.player.isDeveloper = true;
                updatePlayerNameDisplay();
                saveData();
                hideGiftCodePanel();
                
                // ููุงุด ูพุงู ููููุช
                const successMsg = document.createElement('div');
                successMsg.className = 'fixed top-4 left-4 right-4 z-50 text-center';
                successMsg.innerHTML = `
                    <div class="black-card rounded-xl p-4 mx-auto max-w-md border border-green-500 bg-green-900 bg-opacity-20">
                        <div class="text-green-400 font-medium">๐ ุชุจุฑฺฉ! ุดูุง ุจู ุนููุงู ุณุงุฒูุฏู ุดูุงุฎุชู ุดุฏุฏ!</div>
                    </div>
                `;
                document.body.appendChild(successMsg);
                
                setTimeout(() => {
                    document.body.removeChild(successMsg);
                }, 4000);
            } else {
                // ููุงุด ูพุงู ุฎุทุง
                const errorMsg = document.createElement('div');
                errorMsg.className = 'fixed top-4 left-4 right-4 z-50 text-center';
                errorMsg.innerHTML = `
                    <div class="black-card rounded-xl p-4 mx-auto max-w-md border border-red-500 bg-red-900 bg-opacity-20">
                        <div class="text-red-400 font-medium">โ ฺฉุฏ ูุฏู ูุงูุนุชุจุฑ ุงุณุช!</div>
                    </div>
                `;
                document.body.appendChild(errorMsg);
                
                setTimeout(() => {
                    document.body.removeChild(errorMsg);
                }, 3000);
            }
        }

        // ุจูโุฑูุฒุฑุณุงู ููุงุด ูุงู ุจุงุฒฺฉู
        function updatePlayerNameDisplay() {
            const playerNameElement = document.getElementById('playerName');
            if (gameState.player.isDeveloper) {
                playerNameElement.innerHTML = `<svg class="w-4 h-4 inline-block ml-1 text-blue-400" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M11,16.5L18,9.5L16.59,8.09L11,13.67L7.91,10.59L6.5,12L11,16.5Z"/>
                </svg>${gameState.player.name}`;
            } else {
                playerNameElement.textContent = gameState.player.name;
            }
        }

        // ุดุฑูุน ุจุฑูุงูู
        document.addEventListener('DOMContentLoaded', function() {
            // ููุงุด ุตูุญู ููุฏูฺฏ
            showPage('loadingPage');
            
            // ุดุจูโุณุงุฒ ููุฏูฺฏ
            const loadingTexts = [
                'ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ููุงุจุน...',
                'ุจุฑุฑุณ ุงุชุตุงู ุงูุชุฑูุช...',
                'ุขูุงุฏูโุณุงุฒ ุจุงุฒ...',
                'ุจุงุฑฺฏุฐุงุฑ ุณูุงูุงุช...',
                'ุชูุธู ุฑุงุจุท ฺฉุงุฑุจุฑ...',
                'ุชูุฑุจุงู ุขูุงุฏู ุงุณุช...',
                'ุขูุงุฏู!'
            ];
            
            let currentTextIndex = 0;
            const loadingTextElement = document.getElementById('loadingText');
            
            const textInterval = setInterval(() => {
                if (currentTextIndex < loadingTexts.length - 1) {
                    currentTextIndex++;
                    if (loadingTextElement) {
                        loadingTextElement.textContent = loadingTexts[currentTextIndex];
                    }
                }
            }, 1000);
            
            // ุจุฑุฑุณ ุงุชุตุงู ุงูุชุฑูุช ุฏุฑ ููุฏูฺฏ
            setTimeout(() => {
                if (!navigator.onLine) {
                    clearInterval(textInterval);
                    document.getElementById('loadingInternetError').classList.remove('hidden');
                    return;
                }
                
                // ูพุงุงู ููุฏูฺฏ
                clearInterval(textInterval);
                
                // ุจุฑุฑุณ ุงุทูุงุนุงุช ุฐุฎุฑู ุดุฏู
                if (loadSavedData()) {
                    // ุงฺฏุฑ ุงุทูุงุนุงุช ูุฌูุฏ ุฏุงุฑุฏุ ูุณุชูู ุจู ููู ุจุฑู
                    updatePlayerNameDisplay();
                    const cupsElement = document.getElementById('playerCups');
                    if (cupsElement) {
                        cupsElement.textContent = gameState.player.cups;
                    }
                    showPage('mainMenu');
                } else {
                    // ุงฺฏุฑ ุงุทูุงุนุงุช ูุฌูุฏ ูุฏุงุฑุฏุ ุตูุญู ุซุจุช ูุงู ููุงุด ุจุฏู
                    showPage('registerPage');
                }
            }, 7000); // 7 ุซุงูู ููุฏูฺฏ
            
            // ูุธุงุฑุช ุจุฑ ูุถุนุช ุงูุชุฑูุช
            window.addEventListener('online', () => {
                hideInternetError();
                hideLoadingInternetError();
            });
            
            window.addEventListener('offline', () => {
                showInternetError();
            });
        });

        // ูพููุงู ฺฉุฑุฏู ุฎุทุง ุงูุชุฑูุช ุฏุฑ ููุฏูฺฏ
        function hideLoadingInternetError() {
            document.getElementById('loadingInternetError').classList.add('hidden');
        }

        // ุชูุงุด ูุฌุฏุฏ ุงุชุตุงู
        function retryConnection() {
            if (navigator.onLine) {
                hideLoadingInternetError();
                location.reload();
            } else {
                alert('ูููุฒ ุงุชุตุงู ุงูุชุฑูุช ุจุฑูุฑุงุฑ ูุณุช. ูุทูุงู ุงุชุตุงู ุฎูุฏ ุฑุง ุจุฑุฑุณ ฺฉูุฏ.');
            }
        }

        // ุฎุฑูุฌ ุงุฒ ุจุฑูุงูู
        function exitApp() {
            if (confirm('ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ุฎุงุฑุฌ ุดูุฏุ')) {
                window.close();
            }
        }

        // ุงุณุงู ุฑุจุงุชโูุง
        const botNames = [
            'ูุงุทูู', 'ุนู_123', 'ูุฑู_ฺฏู', 'ุฑุถุง_ูพุฑู', 'ุณุงุฑุง_2024', 'ุงูุฑ_ฺฏูุฑ',
            'ูุงุฒูู', 'ูุญูุฏ_ฺฉูู', 'ุฒูุฑุง_ุงุณุชุงุฑ', 'ุญุณู_ูุงุณุชุฑ', 'ุขุฑู_ูพูุฑ',
            'ููููุฑ', 'ฺฉุงู_ฺฏู', 'ูุฏุง_ฺููพ', 'ูพูุฑุง_ูพุฑู', 'ุดุฏุง_ฺฏูุฑ'
        ];

        // ููุถูุนุงุช ุจุงุฒ
        const topics = [
            { name: 'ุณููุง', emoji: '๐ฌ' },
            { name: 'ุงุทูุงุนุงุช ุนููู', emoji: '๐ง' },
            { name: 'ูุฑุฒุด', emoji: 'โฝ' },
            { name: 'ุชุงุฑุฎ', emoji: '๐' },
            { name: 'ุนูู', emoji: '๐ฌ' }
        ];

        // ุณูุงูุงุช
        const questions = {
            'ุณููุง': [
                { q: 'ฺฉุงุฑฺฏุฑุฏุงู ููู "ุฌุฏุง ูุงุฏุฑ ุงุฒ ุณูู" ฺฉุณุชุ', a: ['ุงุตุบุฑ ูุฑูุงุฏ', 'ูุฌุฏ ูุฌุฏ', 'ุนุจุงุณ ฺฉุงุฑุณุชู', 'ุฏุงุฑูุด ููุฑุฌู'], correct: 0 },
                { q: 'ููู "ุชุงุชุงูฺฉ" ุฏุฑ ฺู ุณุงู ุณุงุฎุชู ุดุฏุ', a: ['1997', '1995', '1999', '1996'], correct: 0 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุงุตู ููู "ฺฏุงุฏูุงุฏุฑ" ฺฉุณุชุ', a: ['ูุงุฑููู ุจุฑุงูุฏู', 'ุขู ูพุงฺูู', 'ุฑุงุจุฑุช ุฏูุฑู', 'ุฌูุฒ ฺฉุงู'], correct: 0 },
                { q: 'ููู "ุขูุงุชุงุฑ" ุชูุณุท ฺฉุฏุงู ฺฉุงุฑฺฏุฑุฏุงู ุณุงุฎุชู ุดุฏุ', a: ['ุฌูุฒ ฺฉุงูุฑูู', 'ุงุณุชูู ุงุณูพูุจุฑฺฏ', 'ฺฉุฑุณุชููุฑ ูููุงู', 'ุฑุฏู ุงุณฺฉุงุช'], correct: 0 },
                { q: 'ฺฉุฏุงู ููู ุจุดุชุฑู ุงุณฺฉุงุฑ ุฑุง ุจุฑุฏู ุงุณุชุ', a: ['ุจู ููุฑ', 'ุชุงุชุงูฺฉ', 'ุจุงุฒฺฏุดุช ูพุงุฏุดุงู', 'ููู ููุงุฑุฏ'], correct: 3 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุฌูฺฉุฑ ุฏุฑ ููู "ุดูุงูู ุชุงุฑฺฉ" ฺฉุณุชุ', a: ['ูุซ ูุฌุฑ', 'ุฌฺฉ ูฺฉูุณูู', 'ุฎูุงฺฉู ููฺฉุณ', 'ุฌุฑุฏ ูุชู'], correct: 0 },
                { q: 'ููู "ฺฉุงุฒุงุจูุงูฺฉุง" ุฏุฑ ฺู ุณุงู ุณุงุฎุชู ุดุฏุ', a: ['1942', '1940', '1944', '1945'], correct: 0 },
                { q: 'ฺฉุงุฑฺฏุฑุฏุงู ููู "ูพุงููพ ูฺฉุดู" ฺฉุณุชุ', a: ['ฺฉูุฆูุชู ุชุงุฑุงูุชูู', 'ูุงุฑุชู ุงุณฺฉูุฑุณุฒ', 'ฺฉูุฆู ุจุฑุงุฏุฑุฒ', 'ุฏูุฏ ููฺุฑ'], correct: 0 },
                { q: 'ููู "ุดูุฑููุฏ ฺฉู" ุชูุณุท ฺฉุฏุงู ุจุงุฒฺฏุฑ ฺฉุงุฑฺฏุฑุฏุงู ุดุฏุ', a: ['ุงูุฑุณู ููุฒ', 'ฺุงุฑู ฺุงูพูู', 'ุขููุฑุฏ ูฺฺฉุงฺฉ', 'ุฌุงู ููุฑุฏ'], correct: 0 },
                { q: 'ฺฉุฏุงู ููู ุงููู ููู ุงููุดู ุจููุฏ ุฏุฒู ุงุณุชุ', a: ['ุณูุฏุจุฑู', 'ูพููฺฉู', 'ุจุงูุจ', 'ุณูุฏุฑูุง'], correct: 0 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุงุตู ููู "ุฑุงฺฉ" ฺฉุณุชุ', a: ['ุณููุณุชุฑ ุงุณุชุงูููู', 'ุฑุงุจุฑุช ุฏูุฑู', 'ุขู ูพุงฺูู', 'ุฌุงู ุชุฑุงููุชุง'], correct: 0 },
                { q: 'ููู "ุดูุฏูุฑุฒ ูุณุช" ุฏุฑ ููุฑุฏ ฺู ููุถูุน ุงุณุชุ', a: ['ููููฺฉุงุณุช', 'ุฌูฺฏ ูุชูุงู', 'ุฌูฺฏ ุฌูุงู ุงูู', 'ุฌูฺฏ ุณุฑุฏ'], correct: 0 },
                { q: 'ฺฉุงุฑฺฏุฑุฏุงู ููู "2001: ุงุฏุณู ูุถุง" ฺฉุณุชุ', a: ['ุงุณุชูู ฺฉูุจุฑฺฉ', 'ุฑุฏู ุงุณฺฉุงุช', 'ุฌุฑุฌ ููฺฉุงุณ', 'ุงุณุชูู ุงุณูพูุจุฑฺฏ'], correct: 0 },
                { q: 'ููู "ฺฏุฑฺฏ ูุงู ุงุณุชุฑุช" ุฏุฑ ฺู ุณุงู ุณุงุฎุชู ุดุฏุ', a: ['1987', '1985', '1989', '1990'], correct: 0 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุงุตู ููู "ุชุงฺฉุณ ุฏุฑุงูุฑ" ฺฉุณุชุ', a: ['ุฑุงุจุฑุช ุฏูุฑู', 'ุขู ูพุงฺูู', 'ุฌฺฉ ูฺฉูุณูู', 'ุฏุงุณุชู ูุงููู'], correct: 0 },
                { q: 'ฺฉุฏุงู ููู ุงููู ููู ุฑูฺฏ ุชุงุฑุฎ ุณููุง ุงุณุชุ', a: ['ุฌุงุฏูฺฏุฑ ุขุฒ', 'ุฑูุชู ุจุง ุจุงุฏ', 'ฺฉุงุฒุงุจูุงูฺฉุง', 'ุณูฺฏู ุฏุฑ ุจุงุฑุงู'], correct: 0 },
                { q: 'ููู "ุขูพูฺฉุงููพุณ ูู" ุฏุฑ ููุฑุฏ ฺฉุฏุงู ุฌูฺฏ ุงุณุชุ', a: ['ุฌูฺฏ ูุชูุงู', 'ุฌูฺฏ ุฌูุงู ุฏูู', 'ุฌูฺฏ ฺฉุฑู', 'ุฌูฺฏ ุฎูุฌ ูุงุฑุณ'], correct: 0 },
                { q: 'ฺฉุงุฑฺฏุฑุฏุงู ููู "ูุฑุชฺฏู" ฺฉุณุชุ', a: ['ุขููุฑุฏ ูฺฺฉุงฺฉ', 'ุจู ูุงูุฏุฑ', 'ุฌุงู ููุฑุฏ', 'ูุงูุงุฑุฏ ูุงฺฉุณ'], correct: 0 },
                { q: 'ููู "ฺฉูุฆููพุงุชุฑุง" ุจุง ุจุงุฒ ฺฉุฏุงู ุจุงุฒฺฏุฑ ุณุงุฎุชู ุดุฏุ', a: ['ุงูุฒุงุจุช ุชููุฑ', 'ูุฑูู ูููุฑู', 'ฺฏุฑุณ ฺฉู', 'ุขูุฏุฑ ููพุจูุฑู'], correct: 0 },
                { q: 'ฺฉุฏุงู ููู ุจุดุชุฑู ูุฑูุด ุชุงุฑุฎ ุณููุง ุฑุง ุฏุงุฑุฏุ', a: ['ุขูุงุชุงุฑ', 'ุงูุชูุงูโุฌูุงู', 'ุชุงุชุงูฺฉ', 'ุฌูฺฏ ุณุชุงุฑฺฏุงู'], correct: 0 },
                { q: 'ููู "ุฑุงููุฏฺฏ ุฎูุจ" ุชูุณุท ฺฉุฏุงู ฺฉุงุฑฺฏุฑุฏุงู ุณุงุฎุชู ุดุฏุ', a: ['ูุงุฑุชู ุงุณฺฉูุฑุณุฒ', 'ฺฉูุฆูุชู ุชุงุฑุงูุชูู', 'ุฏูุฏ ููฺุฑ', 'ฺฉุฑุณุชููุฑ ูููุงู'], correct: 0 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุงุตู ููู "ูุงุฑุณุช ฺฏุงููพ" ฺฉุณุชุ', a: ['ุชุงู ููฺฉุณ', 'ฺฉูู ฺฉุงุณุชูุฑ', 'ูู ฺฏุจุณูู', 'ุฑุงุณู ฺฉุฑู'], correct: 0 },
                { q: 'ููู "ูุงุชุฑฺฉุณ" ุฏุฑ ฺู ุณุงู ุณุงุฎุชู ุดุฏุ', a: ['1999', '1998', '2000', '1997'], correct: 0 },
                { q: 'ฺฉุงุฑฺฏุฑุฏุงู ููู "ูุดุช ู ูู" ฺฉุณุชุ', a: ['ูุฏุฑฺฉู ููู', 'ูฺฉูโุขูุฌูู ุขูุชูููู', 'ููฺฉูู ูุณฺฉููุช', 'ูุชูุฑู ุฏุณฺฉุง'], correct: 0 },
                { q: 'ููู "ุณุงฺฉู" ุฏุฑ ฺู ุณุงู ุณุงุฎุชู ุดุฏุ', a: ['1960', '1958', '1962', '1959'], correct: 0 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุงุตู ููู "ุฑูุจู" ฺฉุณุชุ', a: ['ุณููุณุชุฑ ุงุณุชุงูููู', 'ุขุฑูููุฏ ุดูุงุฑุชุฒูฺฏุฑ', 'ุจุฑูุณ ููุณ', 'ฺุงู ฺฉููุฏ ูู ุฏุงู'], correct: 0 },
                { q: 'ฺฉุฏุงู ููู ุงููู ููู ุตูุช ุชุงุฑุฎ ุณููุง ุงุณุชุ', a: ['ุฎูุงููุฏู ุฌุงุฒ', 'ฺุงุฑู ฺุงูพูู', 'ฺฉุงุฒุงุจูุงูฺฉุง', 'ุฑูุชู ุจุง ุจุงุฏ'], correct: 0 },
                { q: 'ููู "ูุงุฑูุณ ุนุฑุจุณุชุงู" ุชูุณุท ฺฉุฏุงู ฺฉุงุฑฺฏุฑุฏุงู ุณุงุฎุชู ุดุฏุ', a: ['ุฏูุฏ ูู', 'ุฌุงู ููุฑุฏ', 'ููุงู ูุงูุฑ', 'ุฌุฑุฌ ุงุณุชููุฒ'], correct: 0 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุงุตู ููู "ฺฉุงุณุงุจูุงูฺฉุง" ฺฉุณุชุ', a: ['ูููุฑ ุจูฺฏุงุฑุช', 'ฺฉุฑ ฺฏุฑุงูุช', 'ุฌูุฒ ุงุณุชูุงุฑุช', 'ฺฉูุงุฑฺฉ ฺฏุจู'], correct: 0 },
                { q: 'ููู "ุฑูุต ุจุง ฺฏุฑฺฏโูุง" ุฏุฑ ฺู ุณุงู ุณุงุฎุชู ุดุฏุ', a: ['1990', '1988', '1992', '1989'], correct: 0 },
                { q: 'ฺฉุงุฑฺฏุฑุฏุงู ููู "ุณููุง ูพุงุฑุงุฏุฒู" ฺฉุณุชุ', a: ['ุฌูุฒูพู ุชูุฑูุงุชูุฑู', 'ูุฏุฑฺฉู ููู', 'ููฺฉุง ฺฏูุงุฏุงููู', 'ูพุงุฆููู ุณูุฑูุชูู'], correct: 0 },
                { q: 'ููู "ุจูุฏ ุฑุงูุฑ" ุจุฑ ุงุณุงุณ ฺฉุฏุงู ุฑูุงู ุณุงุฎุชู ุดุฏุ', a: ['ุขุง ุขูุฏุฑูุฆุฏูุง ุฑูุง ฺฏูุณููุฏ ุงูฺฉุชุฑฺฉ ูโุจููุฏุ', '1984', 'ุฏููู', 'ูุงุฑููุงุช 451'], correct: 0 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุงุตู ููู "ฺฏูุงุฏุงุชูุฑ" ฺฉุณุชุ', a: ['ุฑุงุณู ฺฉุฑู', 'ูู ฺฏุจุณูู', 'ฺฉูู ฺฉุงุณุชูุฑ', 'ุจุฑุฏ ูพุช'], correct: 0 },
                { q: 'ููู "ุดุจโูุง ฺฉุงุจุฑุง" ุชูุณุท ฺฉุฏุงู ฺฉุงุฑฺฏุฑุฏุงู ุณุงุฎุชู ุดุฏุ', a: ['ูุฏุฑฺฉู ููู', 'ูฺฉูโุขูุฌูู ุขูุชูููู', 'ููฺฉูู ูุณฺฉููุช', 'ูุชูุฑู ุฏุณฺฉุง'], correct: 0 },
                { q: 'ฺฉุฏุงู ููู ุจุดุชุฑู ูุงูุฒุฏ ุงุณฺฉุงุฑ ุฑุง ุฏุฑุงูุช ฺฉุฑุฏูุ', a: ['ููู ุฏุฑุจุงุฑู ุญูุง', 'ุชุงุชุงูฺฉ', 'ูุงูุงููุฏ', 'ุจุงุฒฺฏุดุช ูพุงุฏุดุงู'], correct: 0 },
                { q: 'ููู "ุฎุฏุงูพุฏุฑ" ุฏุฑ ฺู ุณุงู ุณุงุฎุชู ุดุฏุ', a: ['1972', '1970', '1974', '1973'], correct: 0 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุงุตู ููู "ฺฉ ุจุฑ ูุฑุงุฒ ุขุดุงู ูุงุฎุชู" ฺฉุณุชุ', a: ['ุฌฺฉ ูฺฉูุณูู', 'ุฑุงุจุฑุช ุฏูุฑู', 'ุขู ูพุงฺูู', 'ุฏุงุณุชู ูุงููู'], correct: 0 },
                { q: 'ฺฉุงุฑฺฏุฑุฏุงู ููู "ููุช" ฺฉุณุชุ', a: ['ุฏูุฏ ููฺุฑ', 'ฺฉุฑุณุชููุฑ ูููุงู', 'ุฏู ููููู', 'ุฑุฏู ุงุณฺฉุงุช'], correct: 0 },
                { q: 'ููู "ุฑูุชู ุจุง ุจุงุฏ" ุฏุฑ ฺู ุณุงู ุณุงุฎุชู ุดุฏุ', a: ['1939', '1937', '1941', '1940'], correct: 0 },
                { q: 'ุจุงุฒฺฏุฑ ููุด ุงุตู ููู "ุดุงูุฒุงุฏู ฺฉูฺููู" ฺฉุณุชุ', a: ['ูุงุฑฺฉ ุขุณุงูุชู', 'ุฌู ุจุฑุฌุฒ', 'ุฑฺู ูฺฉโุขุฏุงูุฒ', 'ููู ููุงุฑุฏ'], correct: 3 }
            ],
            'ุงุทูุงุนุงุช ุนููู': [
                { q: 'ูพุงุชุฎุช ุงุณุชุฑุงูุง ฺฉุฏุงู ุดูุฑ ุงุณุชุ', a: ['ฺฉุงูุจุฑุง', 'ุณุฏู', 'ููุจูุฑู', 'ูพุฑุซ'], correct: 0 },
                { q: 'ุจุฒุฑฺฏุชุฑู ุงูุงููุณ ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุงูุงููุณ ุขุฑุงู', 'ุงูุงููุณ ุงุทูุณ', 'ุงูุงููุณ ููุฏ', 'ุงูุงููุณ ููุฌูุฏ ุดูุงู'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุฌูุนุช ุฑุง ุฏุงุฑุฏุ', a: ['ฺู', 'ููุฏ', 'ุขูุฑฺฉุง', 'ุงูุฏููุฒ'], correct: 0 },
                { q: 'ุจููุฏุชุฑู ฺฉูู ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุงูุฑุณุช', 'K2', 'ฺฉุงูฺูุฌููฺฏุง', 'ูููุชุณู'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ูุฑุฒ ุฒูู ุฑุง ุฏุงุฑุฏุ', a: ['ฺู', 'ุฑูุณู', 'ุจุฑุฒู', 'ููุฏ'], correct: 0 },
                { q: 'ุทููุงูโุชุฑู ุฑูุฏุฎุงูู ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ูู', 'ุขูุงุฒูู', 'ุงูฺฏโุชุณู', 'ูโุณโุณโูพ'], correct: 0 },
                { q: 'ฺฉูฺฺฉุชุฑู ฺฉุดูุฑ ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ูุงุชฺฉุงู', 'ูููุงฺฉู', 'ูุงุฆูุฑู', 'ุณุงู ูุงุฑูู'], correct: 0 },
                { q: 'ฺฉุฏุงู ูุงุฑู ุจุดุชุฑู ฺฉุดูุฑ ุฑุง ุฏุงุฑุฏุ', a: ['ุขูุฑูุง', 'ุขุณุง', 'ุงุฑููพุง', 'ุขูุฑฺฉุง ุฌููุจ'], correct: 0 },
                { q: 'ุนููโุชุฑู ููุทู ุงูุงููุณโูุง ฺฉุฌุงุณุชุ', a: ['ฺฏูุฏุงู ูุงุฑุงูุง', 'ฺฏูุฏุงู ูพูุฑุชูุฑฺฉู', 'ฺฏูุฏุงู ฺุงูพู', 'ฺฏูุฏุงู ูพุฑู-ุดู'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุฌุฒุฑู ุฑุง ุฏุงุฑุฏุ', a: ['ูููุงูุฏ', 'ุณูุฆุฏ', 'ูุฑูฺ', 'ฺฉุงูุงุฏุง'], correct: 0 },
                { q: 'ุจุฒุฑฺฏุชุฑู ุฏุฑุงฺู ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุฏุฑุง ุฎุฒุฑ', 'ุฏุฑุงฺู ุณููพุฑูุฑ', 'ุฏุฑุงฺู ูฺฉุชูุฑุง', 'ุฏุฑุงฺู ููุฑูู'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ููุทูู ุฒูุงู ุฑุง ุฏุงุฑุฏุ', a: ['ูุฑุงูุณู', 'ุฑูุณู', 'ุขูุฑฺฉุง', 'ุงุณุชุฑุงูุง'], correct: 0 },
                { q: 'ุฎุดฺฉโุชุฑู ุจุงุจุงู ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุขุชุงฺฉุงูุง', 'ุตุญุฑุง', 'ฺฏูุจ', 'ฺฉุงูุงูุงุฑ'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุฐุฎุงุฑ ููุช ุฑุง ุฏุงุฑุฏุ', a: ['ููุฒูุฆูุง', 'ุนุฑุจุณุชุงู ุณุนูุฏ', 'ฺฉุงูุงุฏุง', 'ุงุฑุงู'], correct: 0 },
                { q: 'ุจุฒุฑฺฏุชุฑู ุฌุฒุฑู ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ฺฏุฑูููุฏ', 'ฺฏูู ูู', 'ุจูุฑูุฆู', 'ูุงุฏุงฺฏุงุณฺฉุงุฑ'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ูุฑุฒ ุฏุฑุง ุฑุง ุฏุงุฑุฏุ', a: ['ฺฉุงูุงุฏุง', 'ุงูุฏููุฒ', 'ุฑูุณู', 'ุงุณุชุฑุงูุง'], correct: 0 },
                { q: 'ุณุฑุฏุชุฑู ูพุงุชุฎุช ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุงููุงูโุจุงุชูุฑ', 'ููุณูฺฉ', 'ุฑฺฉุงูฺฉ', 'ูุณฺฉู'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุขุชุดูุดุงู ูุนุงู ุฑุง ุฏุงุฑุฏุ', a: ['ุงูุฏููุฒ', 'ฺุงูพู', 'ุดู', 'ุงุณููุฏ'], correct: 0 },
                { q: 'ุจุฒุฑฺฏุชุฑู ุขุจุดุงุฑ ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุขูุฌู', 'ูุงฺฏุงุฑุง', 'ูฺฉุชูุฑุง', 'ุงฺฏูุขุณู'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุฒุจุงู ุฑุณู ุฑุง ุฏุงุฑุฏุ', a: ['ุขูุฑูุง ุฌููุจ', 'ููุฏ', 'ุจููู', 'ุณูุฆุณ'], correct: 0 },
                { q: 'ุนููโุชุฑู ุฏุฑุงฺู ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุจุงฺฉุงู', 'ุชุงูฺฏุงูฺฉุง', 'ุฎุฒุฑ', 'ูุงูุงู'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุฌูุนุช ูุณููุงู ุฑุง ุฏุงุฑุฏุ', a: ['ุงูุฏููุฒ', 'ูพุงฺฉุณุชุงู', 'ููุฏ', 'ุจูฺฏูุงุฏุด'], correct: 0 },
                { q: 'ุจููุฏุชุฑู ุขุจุดุงุฑ ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุขูุฌู', 'ุชูฺฏูุง', 'ูุณูุช', 'ฺฉูฺฉูุงู'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุชููุฏ ุจุฑูุฌ ุฑุง ุฏุงุฑุฏุ', a: ['ฺู', 'ููุฏ', 'ุงูุฏููุฒ', 'ุจูฺฏูุงุฏุด'], correct: 0 },
                { q: 'ฺฏุฑูโุชุฑู ูฺฉุงู ุฒูู ฺฉุฌุงุณุชุ', a: ['ุฏุฑู ูุฑฺฏ', 'ุตุญุฑุง ููุช', 'ุตุญุฑุง ุขุชุงฺฉุงูุง', 'ุตุญุฑุง ฺฉุงูุงูุงุฑ'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุชููุฏ ูููู ุฑุง ุฏุงุฑุฏุ', a: ['ุจุฑุฒู', 'ูุชูุงู', 'ฺฉููุจุง', 'ุงูุฏููุฒ'], correct: 0 },
                { q: 'ุจุฒุฑฺฏุชุฑู ฺฉูุฑ ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุขูุชุงุฑฺฉุชฺฉุง', 'ุตุญุฑุง', 'ุนุฑุจุณุชุงู', 'ฺฏูุจ'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุชููุฏ ฺุง ุฑุง ุฏุงุฑุฏุ', a: ['ฺู', 'ููุฏ', 'ฺฉูุง', 'ุณุฑโูุงูฺฉุง'], correct: 0 },
                { q: 'ุทููุงูโุชุฑู ุฑุดุชู ฺฉูู ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุขูุฏ', 'ุฑุงฺฉ', 'ููุงูุง', 'ุขููพ'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุชููุฏ ฺฏูุฏู ุฑุง ุฏุงุฑุฏุ', a: ['ฺู', 'ููุฏ', 'ุฑูุณู', 'ุขูุฑฺฉุง'], correct: 0 },
                { q: 'ุจุฒุฑฺฏุชุฑู ุฏูุชุง ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ฺฏูฺฏ-ุจุฑููุงูพูุชุฑุง', 'ูู', 'ุขูุงุฒูู', 'ูโุณโุณโูพ'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุชููุฏ ููุช ุฑุง ุฏุงุฑุฏุ', a: ['ุขูุฑฺฉุง', 'ุนุฑุจุณุชุงู ุณุนูุฏ', 'ุฑูุณู', 'ฺฉุงูุงุฏุง'], correct: 0 },
                { q: 'ุณุฑุนโุชุฑู ุญูุงู ุฒูู ฺฉุฏุงู ุงุณุชุ', a: ['ูุฒูพููฺฏ', 'ุดุฑ', 'ฺฏุฒู', 'ุณฺฏ ุชุงุฒ'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุชููุฏ ุจุฑู ุขุจ ุฑุง ุฏุงุฑุฏุ', a: ['ฺู', 'ุจุฑุฒู', 'ฺฉุงูุงุฏุง', 'ุขูุฑฺฉุง'], correct: 0 },
                { q: 'ุจุฒุฑฺฏุชุฑู ุตุฎุฑู ูุฑุฌุงู ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ุตุฎุฑู ุจุฒุฑฺฏ ูุฑุฌุงู', 'ุตุฎุฑู ูุฑุฌุงู ุจูุฒ', 'ุตุฎุฑู ูุฑุฌุงู ูุฑูุฒ', 'ุตุฎุฑู ูุฑุฌุงู ุงูุฏูุงู'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุชููุฏ ุทูุง ุฑุง ุฏุงุฑุฏุ', a: ['ฺู', 'ุงุณุชุฑุงูุง', 'ุฑูุณู', 'ุขูุฑฺฉุง'], correct: 0 },
                { q: 'ุนููโุชุฑู ุบุงุฑ ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ูุฑููุง', 'ฺฉุฑูุจุฑุง', 'ูุงููพุฑุฎุชุณููู', 'ูุฑููุฏุง'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุชููุฏ ุงููุงุณ ุฑุง ุฏุงุฑุฏุ', a: ['ุฑูุณู', 'ุจูุชุณูุงูุง', 'ฺฉูฺฏู', 'ุงุณุชุฑุงูุง'], correct: 0 },
                { q: 'ุจุฒุฑฺฏุชุฑู ุชุงูุงุจ ุฌูุงู ฺฉุฏุงู ุงุณุชุ', a: ['ูพุงูุชุงูุงู', 'ุงูุฑฺฏูุฏุฒ', 'ุงูฺฉุงูุงูฺฏู', 'ฺฉุงูุงุฑฺฏ'], correct: 0 },
                { q: 'ฺฉุฏุงู ฺฉุดูุฑ ุจุดุชุฑู ุชููุฏ ุขูููููู ุฑุง ุฏุงุฑุฏุ', a: ['ฺู', 'ุฑูุณู', 'ฺฉุงูุงุฏุง', 'ููุฏ'], correct: 0 }
            ],
            'ูุฑุฒุด': [
                { q: 'ุฌุงู ุฌูุงู ููุชุจุงู 2022 ุฏุฑ ฺฉุฏุงู ฺฉุดูุฑ ุจุฑฺฏุฒุงุฑ ุดุฏุ', a: ['ูุทุฑ', 'ุฑูุณู', 'ุจุฑุฒู', 'ุขููุงู'], correct: 0 },
                { q: 'ฺฉุฏุงู ูุฑุฒุดฺฉุงุฑ ุจุดุชุฑู ูุฏุงู ุทูุง ุงูููพฺฉ ุฑุง ุฏุงุฑุฏุ', a: ['ูุงฺฉู ูููพุณ', 'ุงูุณู ุจููุช', 'ฺฉุงุฑู ููุฆุณ', 'ูุงุฑฺฉ ุงุณูพุชุฒ'], correct: 0 },
                { q: 'ุชูุณ ููุจูุฏูู ุฏุฑ ฺฉุฏุงู ฺฉุดูุฑ ุจุฑฺฏุฒุงุฑ ูโุดูุฏุ', a: ['ุงูฺฏูุณุชุงู', 'ูุฑุงูุณู', 'ุขูุฑฺฉุง', 'ุงุณุชุฑุงูุง'], correct: 0 }
            ],
            'ุชุงุฑุฎ': [
                { q: 'ุฌูฺฏ ุฌูุงู ุฏูู ุฏุฑ ฺู ุณุงู ูพุงุงู ุงูุชุ', a: ['1945', '1944', '1946', '1943'], correct: 0 },
                { q: 'ุงููพุฑุงุชูุฑ ุฑูู ุฏุฑ ฺู ุณุงู ุณููุท ฺฉุฑุฏุ', a: ['476', '480', '470', '485'], correct: 0 },
                { q: 'ฺฉููุจ ุขูุฑฺฉุง ุฑุง ุฏุฑ ฺู ุณุงู ฺฉุดู ฺฉุฑุฏุ', a: ['1492', '1490', '1494', '1488'], correct: 0 }
            ],
            'ุนูู': [
                { q: 'ูุฑููู ุดูุง ุขุจ ฺุณุชุ', a: ['H2O', 'CO2', 'NaCl', 'CH4'], correct: 0 },
                { q: 'ุณุฑุนุช ููุฑ ุฏุฑ ุฎูุงุก ฺูุฏุฑ ุงุณุชุ', a: ['300000 ฺฉูููุชุฑ ุจุฑ ุซุงูู', '250000 ฺฉูููุชุฑ ุจุฑ ุซุงูู', '350000 ฺฉูููุชุฑ ุจุฑ ุซุงูู', '200000 ฺฉูููุชุฑ ุจุฑ ุซุงูู'], correct: 0 },
                { q: 'ฺฉุฏุงู ุณุงุฑู ุจู ุณุงุฑู ุณุฑุฎ ูุนุฑูู ุงุณุชุ', a: ['ูุฑุฎ', 'ุฒูุฑู', 'ูุดุชุฑ', 'ุฒุญู'], correct: 0 }
            ]
        };

        // ุซุจุช ูุงู
        function register() {
            const username = document.getElementById('username').value.trim();
            const age = document.getElementById('age').value.trim();
            const terms = document.getElementById('terms').checked;

            if (!username) {
                alert('ูุทูุงู ูุงู ฺฉุงุฑุจุฑ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ');
                return;
            }

            if (!age || isNaN(age) || age < 1 || age > 120) {
                alert('ูุทูุงู ุณู ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ (1-120)');
                return;
            }

            if (!terms) {
                alert('ูุทูุงู ููุงูู ุฑุง ุจูพุฐุฑุฏ');
                return;
            }

            // ุฐุฎุฑู ุงุทูุงุนุงุช
            gameState.player.name = username;
            gameState.player.cups = 0;
            gameState.currentLevel = 1;
            gameState.player.isDeveloper = false;
            
            // ุจูโุฑูุฒุฑุณุงู ููุงุด
            updatePlayerNameDisplay();
            document.getElementById('playerCups').textContent = '0';
            
            // ุฐุฎุฑู ุฏุฑ localStorage
            saveData();
            
            // ุฑูุชู ุจู ููู ุงุตู
            showPage('mainMenu');
        }

        // ููุงุด ุตูุญู
        function showPage(pageId) {
            const pages = ['initialLoading', 'loadingPage', 'registerPage', 'mainMenu', 'settingsPage', 'developersPage', 'levelsPage', 'searchingPage', 'opponentPage', 'roundTopicPage', 'gamePage', 'gameEndPage'];
            pages.forEach(page => {
                const element = document.getElementById(page);
                if (element) {
                    element.classList.add('hidden');
                }
            });
            const targetElement = document.getElementById(pageId);
            if (targetElement) {
                targetElement.classList.remove('hidden');
            }
        }

        // ูุฑุงุด ูุงู
        function editName() {
            document.getElementById('newNameInput').value = gameState.player.name;
            document.getElementById('editNamePanel').classList.remove('hidden');
        }

        // ูพููุงู ฺฉุฑุฏู ูพูู ูุฑุงุด ูุงู
        function hideEditNamePanel() {
            document.getElementById('editNamePanel').classList.add('hidden');
        }

        // ุฐุฎุฑู ูุงู ุฌุฏุฏ
        function saveNewName() {
            const newName = document.getElementById('newNameInput').value.trim();
            
            if (newName === '') {
                alert('ูุงู ููโุชูุงูุฏ ุฎุงู ุจุงุดุฏ!');
                return;
            }
            
            gameState.player.name = newName;
            updatePlayerNameDisplay();
            
            // ุจูโุฑูุฒุฑุณุงู ูุงู ุฏุฑ ุตูุญุงุช ุจุงุฒ
            const gamePlayerNameElements = document.querySelectorAll('#gamePlayerName, #finalPlayerName');
            gamePlayerNameElements.forEach(element => {
                if (element) element.textContent = gameState.player.name;
            });
            
            saveData();
            hideEditNamePanel();
            
            // ููุงุด ูพุงู ููููุช
            const successMsg = document.createElement('div');
            successMsg.className = 'fixed top-4 left-4 right-4 z-50 text-center';
            successMsg.innerHTML = `
                <div class="black-card rounded-xl p-3 mx-auto max-w-md border border-green-500 bg-green-900 bg-opacity-20">
                    <div class="text-green-400 font-medium">โ ูุงู ุดูุง ุจุง ููููุช ุชุบุฑ ุงูุช!</div>
                </div>
            `;
            document.body.appendChild(successMsg);
            
            setTimeout(() => {
                document.body.removeChild(successMsg);
            }, 3000);
        }

        // ุชูุธูุงุช
        function showSettings() {
            showPage('settingsPage');
        }

        function hideSettings() {
            showPage('mainMenu');
        }

        // ููุงุด ุณุงุฒูุฏฺฏุงู
        function showDevelopers() {
            showPage('developersPage');
        }

        // ููุงุด ูุฑุงุญู
        function showLevels() {
            const grid = document.getElementById('levelsGrid');
            grid.innerHTML = '';
            
            for (let i = 1; i <= 70; i++) {
                const button = document.createElement('button');
                button.className = `w-12 h-12 rounded-lg font-bold ${i <= gameState.currentLevel ? 'gold-accent text-black hover:bg-yellow-600' : 'bg-gray-700 text-gray-400 border border-gray-600'} transition duration-200`;
                button.textContent = i;
                if (i <= gameState.currentLevel) {
                    button.onclick = () => startSinglePlayer(i);
                }
                grid.appendChild(button);
            }
            
            showPage('levelsPage');
        }

        // ุณูุงูุงุช ุจุงุฒ ุชฺฉ ููุฑู ุจุฑุง 70 ูุฑุญูู
        const singlePlayerQuestions = {
            1: [
                { q: 'ูพุงุชุฎุช ุงุฑุงู ฺฉุฏุงู ุดูุฑ ุงุณุชุ', a: ['ุชูุฑุงู', 'ุงุตููุงู', 'ุดุฑุงุฒ', 'ูุดูุฏ'], correct: 0 },
                { q: '2 + 2 ฺูุฏ ูโุดูุฏุ', a: ['4', '3', '5', '6'], correct: 0 },
                { q: 'ฺฉุฏุงู ุฑูฺฏ ุงุฒ ุชุฑฺฉุจ ูุฑูุฒ ู ุขุจ ุจู ุฏุณุช ูโุขุฏุ', a: ['ุจููุด', 'ุณุจุฒ', 'ุฒุฑุฏ', 'ูุงุฑูุฌ'], correct: 0 }
            ],
            2: [
                { q: 'ุจุฒุฑฺฏุชุฑู ุณุงุฑู ููุธููู ุดูุณ ฺฉุฏุงู ุงุณุชุ', a: ['ูุดุชุฑ', 'ุฒูู', 'ูุฑุฎ', 'ุฒูุฑู'], correct: 0 },
                { q: '5 ร 3 ฺูุฏ ูโุดูุฏุ', a: ['15', '12', '18', '20'], correct: 0 },
                { q: 'ฺฉุฏุงู ุญูุงู ุดุฑ ุชููุฏ ูโฺฉูุฏุ', a: ['ฺฏุงู', 'ุณฺฏ', 'ฺฏุฑุจู', 'ุฎุฑฺฏูุด'], correct: 0 }
            ],
            3: [
                { q: 'ุงููู ุฑุฆุณ ุฌูููุฑ ุขูุฑฺฉุง ฺฉ ุจูุฏุ', a: ['ุฌูุฑุฌ ูุงุดูฺฏุชู', 'ุขุจุฑุงูุงู ููฺฉูู', 'ุชููุงุณ ุฌูุฑุณูู', 'ุฌุงู ุขุฏุงูุฒ'], correct: 0 },
                { q: '10 - 7 ฺูุฏ ูโุดูุฏุ', a: ['3', '4', '2', '5'], correct: 0 },
                { q: 'ฺฉุฏุงู ูุตู ุจุนุฏ ุงุฒ ุฒูุณุชุงู ูโุขุฏุ', a: ['ุจูุงุฑ', 'ุชุงุจุณุชุงู', 'ูพุงุฒ', 'ุฒูุณุชุงู'], correct: 0 }
            ]
        };

        // ุดุฑูุน ุจุงุฒ ุชฺฉ ููุฑู
        function startSinglePlayer(level) {
            gameState.isOnlineGame = false;
            gameState.currentLevel = level;
            
            if (level <= 3) {
                startSinglePlayerGame(level);
            } else {
                alert(`ูุฑุญูู ${level} ูููุฒ ุขูุงุฏู ูุณุช! ูุนูุงู ููุท 3 ูุฑุญูู ุงูู ุขูุงุฏู ุงุณุช.`);
            }
        }

        // ุดุฑูุน ุจุงุฒ ุชฺฉ ููุฑู
        function startSinglePlayerGame(level) {
            gameState.player.score = 0;
            gameState.player.correct = 0;
            gameState.player.wrong = 0;
            gameState.currentQuestion = 0;
            
            document.getElementById('gamePlayerName').textContent = gameState.player.name;
            document.getElementById('gameOpponentName').textContent = `ูุฑุญูู ${level}`;
            document.getElementById('gameTopicName').textContent = `ูุฑุญูู ${level}`;
            document.getElementById('gameRoundNum').textContent = '1';
            
            updateScores();
            showPage('gamePage');
            
            gameState.timer = 60; // ุฒูุงู ุจุดุชุฑ ุจุฑุง ุจุงุฒ ุชฺฉ ููุฑู
            startGameTimer();
            showSinglePlayerQuestion(level);
        }

        // ููุงุด ุณูุงู ุจุงุฒ ุชฺฉ ููุฑู
        function showSinglePlayerQuestion(level) {
            const levelQuestions = singlePlayerQuestions[level];
            if (!levelQuestions || gameState.currentQuestion >= levelQuestions.length) {
                endSinglePlayerGame(level);
                return;
            }
            
            const question = levelQuestions[gameState.currentQuestion];
            
            document.getElementById('questionText').textContent = question.q;
            
            const answersGrid = document.getElementById('answersGrid');
            answersGrid.innerHTML = '';
            
            question.a.forEach((answer, index) => {
                const button = document.createElement('button');
                button.className = 'bg-gray-800 hover:bg-gray-700 text-yellow-400 font-medium py-3 px-4 rounded-lg transition duration-200 border border-yellow-500';
                button.textContent = answer;
                button.onclick = () => selectSinglePlayerAnswer(index, question.correct, level);
                answersGrid.appendChild(button);
            });
            
            document.getElementById('gameStatus').textContent = `ุณูุงู ${gameState.currentQuestion + 1} ุงุฒ ${levelQuestions.length}`;
        }

        // ุงูุชุฎุงุจ ูพุงุณุฎ ุฏุฑ ุจุงุฒ ุชฺฉ ููุฑู
        function selectSinglePlayerAnswer(selected, correct, level) {
            // ุบุฑูุนุงู ฺฉุฑุฏู ุชูุงู ุฏฺฉููโูุง
            const answerButtons = document.querySelectorAll('#answersGrid button');
            answerButtons.forEach(button => {
                button.disabled = true;
                button.classList.add('opacity-50', 'cursor-not-allowed');
                button.onclick = null;
            });
            
            if (selected === correct) {
                gameState.player.correct++;
                document.getElementById('gameStatus').textContent = 'โ ูพุงุณุฎ ุฏุฑุณุช!';
            } else {
                gameState.player.wrong++;
                document.getElementById('gameStatus').textContent = 'โ ูพุงุณุฎ ุบูุท!';
            }
            
            updateScores();
            gameState.currentQuestion++;
            
            // ููุงุด ุชุงูุฑ ุณูุงู ุจุนุฏ
            showNextQuestionTimer();
            
            setTimeout(() => {
                hideNextQuestionTimer();
                showSinglePlayerQuestion(level);
            }, 5000);
        }

        // ูพุงุงู ุจุงุฒ ุชฺฉ ููุฑู
        function endSinglePlayerGame(level) {
            clearInterval(gameState.gameTimer);
            
            const totalQuestions = singlePlayerQuestions[level].length;
            const correctAnswers = gameState.player.correct;
            const percentage = (correctAnswers / totalQuestions) * 100;
            
            document.getElementById('finalPlayerName').textContent = gameState.player.name;
            document.getElementById('finalPlayerCorrect').textContent = `${gameState.player.correct} โ`;
            document.getElementById('finalPlayerWrong').textContent = `${gameState.player.wrong} โ`;
            
            document.getElementById('finalOpponentName').textContent = `ูุฑุญูู ${level}`;
            document.getElementById('finalOpponentCorrect').textContent = `${Math.floor(totalQuestions * 0.7)} โ`;
            document.getElementById('finalOpponentWrong').textContent = `${totalQuestions - Math.floor(totalQuestions * 0.7)} โ`;
            
            if (percentage >= 70) {
                document.getElementById('resultEmoji').textContent = '๐';
                document.getElementById('resultTitle').textContent = 'ูุฑุญูู ฺฏุฐุฑุงูุฏู ุดุฏ!';
                gameState.player.cups += 20;
                if (gameState.currentLevel === level) {
                    gameState.currentLevel++;
                }
            } else {
                document.getElementById('resultEmoji').textContent = '๐';
                document.getElementById('resultTitle').textContent = 'ูุฑุญูู ูุงูููู!';
                gameState.player.cups = Math.max(0, gameState.player.cups - 10);
            }
            
            document.getElementById('playerCups').textContent = gameState.player.cups;
            saveData();
            showPage('gameEndPage');
        }

        // ุจุฑุฑุณ ุงุชุตุงู ุงูุชุฑูุช
        function checkInternetConnection() {
            return navigator.onLine;
        }

        // ููุงุด ุฎุทุง ุงูุชุฑูุช
        function showInternetError() {
            document.getElementById('internetError').classList.remove('hidden');
            setTimeout(() => {
                hideInternetError();
            }, 5000); // ุฎูุฏฺฉุงุฑ ูพููุงู ุดุฏู ุจุนุฏ ุงุฒ 5 ุซุงูู
        }

        // ูพููุงู ฺฉุฑุฏู ุฎุทุง ุงูุชุฑูุช
        function hideInternetError() {
            document.getElementById('internetError').classList.add('hidden');
        }

        // ุดุฑูุน ุจุงุฒ ุขููุงู
        function startOnlineGame() {
            if (!checkInternetConnection()) {
                showInternetError();
                return;
            }
            
            gameState.isOnlineGame = true;
            showPage('searchingPage');
            
            // ุงููุดู ุขูุงุฑ ุฌุณุชุฌู
            let searchTime = 0;
            let foundCount = 0;
            
            const searchInterval = setInterval(() => {
                searchTime++;
                if (searchTime > 3) foundCount = Math.min(foundCount + Math.floor(Math.random() * 2), 5);
                
                document.getElementById('searchTime').textContent = searchTime;
                document.getElementById('foundCount').textContent = foundCount;
                
                // ุชุบุฑ ูุชู ูุถุนุช
                const statuses = [
                    'ุฌุณุชุฌู ุจุงุฒฺฉูุงู ุขููุงู...',
                    'ุจุฑุฑุณ ุณุทุญ ููุงุฑุช...',
                    'ุชุทุจู ฺฉุงูพโูุง...',
                    'ุงูุชู ุจูุชุฑู ุญุฑู...'
                ];
                document.getElementById('searchStatus').textContent = statuses[searchTime % statuses.length];
            }, 1000);
            
            // ุดุจูโุณุงุฒ ุฌุณุชุฌู
            setTimeout(() => {
                clearInterval(searchInterval);
                
                const botName = botNames[Math.floor(Math.random() * botNames.length)];
                
                // ุชุทุจู ฺฉุงูพ ุฑุจุงุช ุจุง ูพูุฑ
                let botCups;
                if (gameState.player.cups <= 10) {
                    botCups = Math.floor(Math.random() * 15); // 0-15
                } else if (gameState.player.cups <= 100) {
                    botCups = gameState.player.cups + Math.floor(Math.random() * 40) - 20; // ยฑ20
                } else if (gameState.player.cups <= 500) {
                    botCups = gameState.player.cups + Math.floor(Math.random() * 100) - 50; // ยฑ50
                } else {
                    botCups = gameState.player.cups + Math.floor(Math.random() * 200) - 100; // ยฑ100
                }
                
                botCups = Math.max(0, botCups); // ุญุฏุงูู 0
                
                gameState.opponent.name = botName;
                gameState.opponent.cups = botCups;
                
                document.getElementById('opponentName').textContent = botName;
                document.getElementById('opponentCups').textContent = botCups;
                
                showPage('opponentPage');
            }, Math.random() * 3000 + 4000);
        }

        // ุดุฑูุน ูุจุฑุฏ
        function startBattle() {
            gameState.currentRound = 1;
            gameState.player.score = 0;
            gameState.opponent.score = 0;
            gameState.player.correct = 0;
            gameState.player.wrong = 0;
            gameState.opponent.correct = 0;
            gameState.opponent.wrong = 0;
            
            showRoundTopic();
        }

        // ููุงุด ููุถูุน ุฑุงูุฏ
        function showRoundTopic() {
            const topic = topics[(gameState.currentRound - 1) % topics.length];
            
            document.getElementById('currentRoundNum').textContent = gameState.currentRound;
            document.getElementById('topicEmoji').textContent = topic.emoji;
            document.getElementById('topicName').textContent = topic.name;
            
            showPage('roundTopicPage');
            
            let countdown = 3;
            const countdownInterval = setInterval(() => {
                document.getElementById('countdown').textContent = countdown;
                countdown--;
                
                if (countdown < 0) {
                    clearInterval(countdownInterval);
                    startRound();
                }
            }, 1000);
        }

        // ุดุฑูุน ุฑุงูุฏ
        function startRound() {
            const topic = topics[(gameState.currentRound - 1) % topics.length];
            
            document.getElementById('gamePlayerName').textContent = gameState.player.name;
            document.getElementById('gameOpponentName').textContent = gameState.opponent.name;
            document.getElementById('gameTopicName').textContent = topic.name;
            document.getElementById('gameRoundNum').textContent = gameState.currentRound;
            
            updateScores();
            showPage('gamePage');
            
            gameState.timer = 40;
            gameState.currentQuestion = 0;
            
            startGameTimer();
            showNextQuestion();
        }

        // ุชุงูุฑ ุจุงุฒ
        function startGameTimer() {
            gameState.gameTimer = setInterval(() => {
                gameState.timer--;
                document.getElementById('timer').textContent = gameState.timer;
                
                if (gameState.timer <= 0) {
                    endRound();
                }
            }, 1000);
        }

        // ููุงุด ุณูุงู ุจุนุฏ
        function showNextQuestion() {
            const topic = topics[(gameState.currentRound - 1) % topics.length];
            const topicQuestions = questions[topic.name];
            const question = topicQuestions[Math.floor(Math.random() * topicQuestions.length)];
            
            document.getElementById('questionText').textContent = question.q;
            
            const answersGrid = document.getElementById('answersGrid');
            answersGrid.innerHTML = '';
            
            question.a.forEach((answer, index) => {
                const button = document.createElement('button');
                button.className = 'bg-gray-800 hover:bg-gray-700 text-yellow-400 font-medium py-3 px-4 rounded-lg transition duration-200 border border-yellow-500';
                button.textContent = answer;
                button.onclick = () => selectAnswer(index, question.correct);
                answersGrid.appendChild(button);
            });
            
            document.getElementById('gameStatus').textContent = 'ููุชุธุฑ ูพุงุณุฎ ุดูุง...';
            gameState.playerAnswered = false;
            
            // ุดุจูโุณุงุฒ ูพุงุณุฎ ุฑุจุงุช (ูุณุชูู ุงุฒ ูพูุฑ)
            setTimeout(() => {
                simulateBotAnswer(question.correct);
            }, Math.random() * 5000 + 2000);
            
            // ุชุงูุฑ ุณูุงู - ููุท ุงฺฏุฑ ูพูุฑ ูพุงุณุฎ ูุฏุงุฏู ุจุงุดุฏ
            gameState.questionTimer = setTimeout(() => {
                if (!gameState.playerAnswered && gameState.timer > 0) {
                    showNextQuestion();
                }
            }, 5000); // 5 ุซุงูู ุจุฑุง ูุฑ ุณูุงู
        }

        // ุงูุชุฎุงุจ ูพุงุณุฎ
        function selectAnswer(selected, correct) {
            if (gameState.playerAnswered) return; // ุฌููฺฏุฑ ุงุฒ ูพุงุณุฎ ูฺฉุฑุฑ
            
            gameState.playerAnswered = true;
            clearTimeout(gameState.questionTimer);
            
            // ุบุฑูุนุงู ฺฉุฑุฏู ุชูุงู ุฏฺฉููโูุง
            const answerButtons = document.querySelectorAll('#answersGrid button');
            answerButtons.forEach(button => {
                button.disabled = true;
                button.classList.add('opacity-50', 'cursor-not-allowed');
                button.onclick = null;
            });
            
            if (selected === correct) {
                gameState.player.correct++;
                document.getElementById('gameStatus').textContent = 'โ ูพุงุณุฎ ุฏุฑุณุช!';
            } else {
                gameState.player.wrong++;
                document.getElementById('gameStatus').textContent = 'โ ูพุงุณุฎ ุบูุท!';
            }
            
            updateScores();
            
            // ููุงุด ุชุงูุฑ ุณูุงู ุจุนุฏ
            showNextQuestionTimer();
            
            // ุญุชูุงู 5 ุซุงูู ุตุจุฑ ฺฉุฑุฏู
            setTimeout(() => {
                hideNextQuestionTimer();
                if (gameState.timer > 0) {
                    showNextQuestion();
                }
            }, 5000);
        }

        // ููุงุด ุชุงูุฑ ุณูุงู ุจุนุฏ
        function showNextQuestionTimer() {
            document.getElementById('nextQuestionTimer').classList.remove('hidden');
            let countdown = 5;
            document.getElementById('nextQuestionCountdown').textContent = countdown;
            
            const timerInterval = setInterval(() => {
                countdown--;
                document.getElementById('nextQuestionCountdown').textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(timerInterval);
                }
            }, 1000);
        }

        // ูพููุงู ฺฉุฑุฏู ุชุงูุฑ ุณูุงู ุจุนุฏ
        function hideNextQuestionTimer() {
            document.getElementById('nextQuestionTimer').classList.add('hidden');
        }

        // ุดุจูโุณุงุฒ ูพุงุณุฎ ุฑุจุงุช
        function simulateBotAnswer(correct) {
            const chance = Math.random();
            if (chance < 0.6) { // 60% ุงุญุชูุงู ูพุงุณุฎ ุฏุฑุณุช
                gameState.opponent.correct++;
            } else if (chance < 0.9) { // 30% ุงุญุชูุงู ูพุงุณุฎ ุบูุท
                gameState.opponent.wrong++;
            }
            // 10% ุงุญุชูุงู ุนุฏู ูพุงุณุฎ
            
            updateScores();
        }

        // ุจูโุฑูุฒุฑุณุงู ุงูุชุงุฒูุง
        function updateScores() {
            document.getElementById('playerScore').textContent = `${gameState.player.correct} โ`;
            document.getElementById('opponentScore').textContent = `${gameState.opponent.correct} โ`;
        }

        // ูพุงุงู ุฑุงูุฏ
        function endRound() {
            clearInterval(gameState.gameTimer);
            clearTimeout(gameState.questionTimer);
            
            if (gameState.currentRound < 3) {
                gameState.currentRound++;
                setTimeout(() => {
                    showRoundTopic();
                }, 1000);
            } else {
                endGame();
            }
        }

        // ูพุงุงู ุจุงุฒ
        function endGame() {
            const playerTotal = gameState.player.correct;
            const opponentTotal = gameState.opponent.correct;
            
            document.getElementById('finalPlayerName').textContent = gameState.player.name;
            document.getElementById('finalPlayerCorrect').textContent = `${gameState.player.correct} โ`;
            document.getElementById('finalPlayerWrong').textContent = `${gameState.player.wrong} โ`;
            
            document.getElementById('finalOpponentName').textContent = gameState.opponent.name;
            document.getElementById('finalOpponentCorrect').textContent = `${gameState.opponent.correct} โ`;
            document.getElementById('finalOpponentWrong').textContent = `${gameState.opponent.wrong} โ`;
            
            if (playerTotal > opponentTotal) {
                document.getElementById('resultEmoji').textContent = '๐';
                document.getElementById('resultTitle').textContent = 'ูพุฑูุฒ!';
                gameState.player.cups += 30;
            } else if (playerTotal < opponentTotal) {
                document.getElementById('resultEmoji').textContent = '๐';
                document.getElementById('resultTitle').textContent = 'ุดฺฉุณุช!';
                gameState.player.cups = Math.max(0, gameState.player.cups - 20);
            } else {
                document.getElementById('resultEmoji').textContent = '๐ค';
                document.getElementById('resultTitle').textContent = 'ูุณุงู!';
                gameState.player.cups += 10;
            }
            
            document.getElementById('playerCups').textContent = gameState.player.cups;
            saveData();
            
            showPage('gameEndPage');
        }

        // ุจุงุฒฺฏุดุช ุจู ููู
        function backToMenu() {
            // ูพุงฺฉ ฺฉุฑุฏู ุชูุงู ุชุงูุฑูุง
            if (gameState.gameTimer) {
                clearInterval(gameState.gameTimer);
                gameState.gameTimer = null;
            }
            if (gameState.questionTimer) {
                clearTimeout(gameState.questionTimer);
                gameState.questionTimer = null;
            }
            
            // ุฑุณุช ฺฉุฑุฏู ูุถุนุช ุจุงุฒ
            gameState.playerAnswered = false;
            gameState.currentQuestion = 0;
            gameState.currentRound = 1;
            gameState.timer = 40;
            
            // ูพููุงู ฺฉุฑุฏู ุชุงูุฑ ุณูุงู ุจุนุฏ
            hideNextQuestionTimer();
            
            showPage('mainMenu');
        }

        // ุจุงุฒฺฏุดุช ุจู ููู ุงุฒ ุตูุญู ูุชุงุฌ
        function backToMenuFromResults() {
            // ูพุงฺฉ ฺฉุฑุฏู ุชูุงู ุชุงูุฑูุง
            if (gameState.gameTimer) {
                clearInterval(gameState.gameTimer);
                gameState.gameTimer = null;
            }
            if (gameState.questionTimer) {
                clearTimeout(gameState.questionTimer);
                gameState.questionTimer = null;
            }
            
            // ุฑุณุช ฺฉุฑุฏู ูุถุนุช ุจุงุฒ
            gameState.playerAnswered = false;
            gameState.currentQuestion = 0;
            gameState.currentRound = 1;
            gameState.timer = 40;
            
            // ูพููุงู ฺฉุฑุฏู ุชุงูุฑ ุณูุงู ุจุนุฏ
            hideNextQuestionTimer();
            
            showPage('mainMenu');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96fa000203cac936',t:'MTc1NTI3NDYyNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
